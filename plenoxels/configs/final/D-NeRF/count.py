import numpy as np


D=np.array( [[[-0.22035998058960343], [0.030851358278917364], [-0.005323214793524837], [0.0022231941160571482], [0.06431227093072142]], [[-0.29837767696860923], [0.2900311373983453], [-0.008075583086745528], [0.006897860347366247], [-0.18321637588194126]], [[-0.2943120353264696], [0.33886423815673955], [-0.008050293833547537], [0.008539352471412544], [-0.30444232716674463]], [[-0.26265465356611856], [0.32583690539586657], [-0.003598152699784845], [0.001177884607244493], [-0.39125625702785977]], [[-0.29951973657515224], [0.4370181854597211], [-0.0025291764103498836], [0.007695462050477205], [-0.5673331147089042]], [[-0.342098285817037], [0.4739971688187653], [-0.01028675103896816], [0.00036411136656284363], [-0.4269197191695306]], [[-0.2399190145206579], [0.10028162232178148], [-0.0014004328305969374], [0.0015674643166853814], [0.01760963310013991]], [[-0.23230762402360033], [-0.0560215046153744], [-0.0029043233422317754], [-0.00045792847218769066], [0.556913097255995]], [[-0.23715928341449133], [0.06768797222862148], [-0.0032693033642682734], [0.0007898694761666919], [0.14430452495425825]], [[-0.2913319235138128], [0.3598984410384766], [-0.003329742930628285], [0.005825055792447187], [-0.6235722477662091]], [[-0.2747136743246008], [0.2326759430716582], [-0.00734183683002649], [0.009944471659394667], [-0.12501374407508456]], [[-0.27596060192696187], [0.10354242729541484], [-0.009192536173826133], [0.014000854069313937], [0.14758992736542245]], [[-0.3294216963668305], [0.6341285620565135], [-0.005448818982758689], [0.0035748771064801435], [-0.9261998713035587]], [[-0.27989863588778285], [0.26862609961536077], [-0.0031226769517469855], [0.004373419260538504], [-0.2138825275388277]], [[-0.22427900327432443], [-0.009036994632938847], [-0.006339972519858119], [0.002461100377584709], [0.2594788026280296]], [[-0.23718170788761658], [0.16068174960880816], [-0.002540123720151124], [-0.0011691277567362087], [-0.13774692051662846]], [[-0.3078294034977875], [0.4189429691608687], [-0.007316150698012016], [0.004911935926856619], [-0.3887990191033832]], [[-0.29779699363839646], [0.3906174511995002], [-0.007119724886581823], [0.008858012028610734], [-0.4136820641719267]], [[-0.30792280632994773], [0.30907496810626744], [-0.005824412067194542], [0.008877356365944484], [-0.1380515823252725]], [[-0.2672806604210188], [0.22349690566460717], [-0.004180989391535901], [0.007255567561919614], [-0.11382752990157738]], [[-0.25644116785054966], [0.10707815072954464], [-0.011240724434681666], [0.0030547252231559216], [0.03793737364441287]], [[-0.2929772493234391], [0.42753425706840437], [-0.0036577694885466805], [0.007519790236617684], [-0.48095986960655795]], [[-0.22267021840260626], [0.04618747447635842], [-0.005257343319146158], [0.0026515918061338823], [0.07565871173072196]]])

print(D.shape)

t_1000=np.array([[[-583.6727753656252], [1021.0756832964976], [2722.228986795223]], [[-304.7829910482591], [774.3597723496073], [2965.4925865090195]], [[-338.8335400234419], [853.48997807196], [3071.2592107479377]], [[-780.1690198680153], [548.0171746585405], [3016.588657657954]], [[-718.1919579474642], [786.1628490165468], [3233.7648218434965]], [[-1074.6480430730837], [713.1088614795317], [3361.9948549380956]], [[-982.0022266596015], [776.1900343103517], [3444.060011789055]], [[-281.9964505165498], [676.9856302446406], [3772.4706582046892]], [[-159.54412205031605], [623.0474030965556], [3849.3839859567347]], [[-685.7559130872035], [612.3810318309769], [3869.6926124633965]], [[183.2754205353128], [481.160758998941], [3963.5258979295913]], [[-240.46097318620758], [469.35083042944194], [4005.4911763039504]], [[-127.70097367068823], [616.2538061024134], [3872.680463465752]], [[318.7067373876656], [798.7396571219874], [3685.017808922207]], [[530.8365451410806], [537.7022743021611], [3641.848606088255]], [[624.5425787249212], [1049.780854713087], [3294.4914783161744]], [[611.1084786962041], [806.7695325569487], [3258.1654900436642]], [[567.4178933026138], [527.830591653219], [3154.7710069276154]], [[514.5707503384808], [727.7841170455737], [3014.3679542740356]], [[301.0930350390155], [931.3466533738782], [2765.7728507912334]], [[256.6030451602909], [1063.2968986237336], [2774.5553341072655]], [[167.2894622283881], [1117.8053703736398], [2661.701341492126]], [[13.931045691714434], [1048.77049784238], [2714.531065959879]]])

t = t_1000 / 1000
print(t.shape)

R=np.array([[[-0.21479375733966127, 0.9753060382641264, -0.05139818609100366], [-0.2844034796216689, -0.012115525750607314, 0.9586281212309984], [0.9343330790392675, 0.22052515902119008, 0.2799827702764606]], [[0.2544730685550706, 0.9576307426373738, -0.1348585115443519], [-0.3329511088131063, 0.21767923238784648, 0.9174744197672003], [0.9079576072263997, -0.18857123996736547, 0.3742377198210795]], [[0.40680522075263814, 0.9133080637716665, -0.019439470621572585], [-0.31590107294779657, 0.16061178416626226, 0.9350991214290392], [0.8571557760867207, -0.3742622548916463, 0.3538527095905754]], [[0.5138708319955838, 0.8524325815648188, -0.09641297584301062], [-0.3000874813184089, 0.2839028376694115, 0.9106847326705491], [0.8036692550920062, -0.43904199417594925, 0.40169373379462325]], [[0.7669875547204812, 0.641661036940957, -0.0010975316636776533], [-0.20683678491369709, 0.24885369813745695, 0.9461978552765149], [0.6074114217813672, -0.7254949693796418, 0.3235867953028534]], [[0.8489622402321794, 0.5279998386361686, -0.021892580024727437], [-0.14984845498262872, 0.2802525647036306, 0.9481581832776408], [0.5067628194720664, -0.8016699260775705, 0.3170438052123152]], [[0.977547590067654, 0.19164387581879905, -0.08759756853971883], [0.02660382672544656, 0.30013951399395833, 0.9535242569242971], [0.2090285759327763, -0.9344457699623981, 0.28830219812359453]], [[0.9732128984951871, -0.21032253132976694, -0.09284980892622048], [0.15517797776748063, 0.3029414569426709, 0.9402905236582186], [-0.16963622672823087, -0.9295111115422403, 0.3274639584762225]], [[0.9274102286777285, -0.3738783102734249, 0.011192714193274639], [0.11784096290890567, 0.3204439661855115, 0.9399091296481807], [-0.35499827493190106, -0.8703623806452043, 0.3412411920518785]], [[0.9169514516132075, -0.3929030225425366, 0.06947841579491057], [0.07632515226897779, 0.34364165229239296, 0.935994062983773], [-0.39163057403061485, -0.8529581640893608, 0.34509109492677154]], [[0.613393311888152, -0.7870755278849754, -0.06527448456687612], [0.3200164524445227, 0.1721352288446225, 0.9316431361607468], [-0.7220374748554999, -0.5923525777737416, 0.3574637163532778]], [[0.47280565487257814, -0.8785591907323818, -0.06773891865223869], [0.3675135004718124, 0.12674364570341778, 0.9213413456720377], [-0.8008674295359172, -0.46051036541371004, 0.3828074759654827]], [[0.32946518149498005, -0.9430017877589696, 0.046907594969974264], [0.32566214871092874, 0.16013131544963438, 0.9318273051962744], [-0.8862261895698302, -0.2917286240596851, 0.3598576813474769]], [[-0.0739302053901329, -0.9972249306271117, -0.00876141921866641], [0.3174219561847597, -0.03185910856539692, 0.9477490696029509], [-0.9453981311927866, 0.06728621654670969, 0.31889643867565554]], [[-0.4193282223453825, -0.9076190519676294, 0.019786319770062843], [0.34372907522740637, -0.13855808114085683, 0.9287906012626719], [-0.8402464904942916, 0.39626924515529266, 0.3700763712479912]], [[-0.6518820049915756, -0.7582978288713623, 0.0058527170734169465], [0.19848252743401007, -0.16316935317301384, 0.9664266389584404], [-0.7318842380264592, 0.6311577971585856, 0.25687603472171305]], [[-0.823679916707353, -0.5646709030947599, -0.05194387366298711], [0.1689314654641827, -0.33179450580513214, 0.9281026699097745], [-0.5413072646742252, 0.7556845751473802, 0.36868315407030994]], [[-0.9455572678474246, -0.318518851994766, 0.06683707163580749], [0.2003233348061008, -0.4077480512421099, 0.8908490827521934], [-0.2564995414285892, 0.8557378498303075, 0.449355891932803]], [[-0.9953429134010084, -0.03187069240962556, 0.09097661077290024], [0.09624350028497985, -0.3818829666270638, 0.9191858291189045], [0.005447329188495581, 0.92366100857698, 0.38317185157480993]], [[-0.9834881924102296, 0.18097203500754977, -0.0003129454990896813], [-0.05965860265397274, -0.32257969623011495, 0.9446603573292689], [0.17085615739280402, 0.9290809771625468, 0.32804986108159284]], [[-0.8667670082758299, 0.4946522739025352, 0.06351441795072052], [-0.11274602623704152, -0.31841702602897104, 0.9412220413391422], [0.48580169506942217, 0.8086592146620953, 0.33176345128684614]], [[-0.6652343238291282, 0.7461255657576097, -0.027566909919131577], [-0.25879476799345114, -0.1957902860254639, 0.9458812990842365], [0.7003488862408638, 0.6363668784757373, 0.3233398112206838]], [[-0.5495799281481262, 0.83250983625284, 0.06992335174296449], [-0.24072683383760657, -0.23794872273675227, 0.940973430452991], [0.8000078087414035, 0.5003076832212535, 0.3311792989644132]]])

print(R.shape)

K=np.array ([[[1.07428138836669, 0.0, 0.5428342057421918], [0.0, 1.0754229146070927, 0.48488356114136775], [0.0, 0.0, 1.0]], [[1.0762495955418644, 0.0, 0.5571903335080212], [0.0, 1.0782845876384815, 0.4816073320431497], [0.0, 0.0, 1.0]], [[1.0752489748712026, 0.0, 0.5541689173369479], [0.0, 1.0785259638295427, 0.4677841962231977], [0.0, 0.0, 1.0]], [[1.026655612329791, 0.0, 0.498498939715419], [0.0, 1.0278705021764456, 0.48197086070716034], [0.0, 0.0, 1.0]], [[1.0477129462732446, 0.0, 0.5320307548999718], [0.0, 1.051329274287652, 0.50943473445495744], [0.0, 0.0, 1.0]], [[1.0921328430152896, 0.0, 0.503169896613522], [0.0, 1.0968298827658252, 0.51132692738666515], [0.0, 0.0, 1.0]], [[1.0451707619285985, 0.0, 0.521354505078134], [0.0, 1.047629439037288, 0.4971463007879668], [0.0, 0.0, 1.0]], [[1.0683282866376944, 0.0, 0.49098907844069333], [0.0, 1.073517093286327, 0.48531224424358606], [0.0, 0.0, 1.0]], [[1.07199914143861, 0.0, 0.5037849615296313], [0.0, 1.0757069508277768, 0.4782875961223012], [0.0, 0.0, 1.0]], [[1.0923847397901995, 0.0, 0.5366736928747547], [0.0, 1.097082062271403, 0.49056644177497316], [0.0, 0.0, 1.0]], [[1.0879891048955728, 0.0, 0.5349829382939131], [0.0, 1.0944882794156008, 0.4817845866939248], [0.0, 0.0, 1.0]], [[1.109191725583323, 0.0, 0.5644089622019632], [0.0, 1.1106791422331817, 0.51030668905721933], [0.0, 0.0, 1.0]], [[1.0844058116048157, 0.0, 0.4805553538729001], [0.0, 1.0875885252383673, 0.48013293996705187], [0.0, 0.0, 1.0]], [[1.067793648082808, 0.0, 0.5566232384755389], [0.0, 1.0712424274514806, 0.5026456339468654], [0.0, 0.0, 1.0]], [[1.0915518073309697, 0.0, 0.5153807747903012], [0.0, 1.0932638635228452, 0.4800173285787862], [0.0, 0.0, 1.0]], [[1.0570864073900682, 0.0, 0.510436432393605], [0.0, 1.0602368015090767, 0.47724569058951175], [0.0, 0.0, 1.0]], [[1.0702849599120098, 0.0, 0.5231721109531996], [0.0, 1.0760313155283059, 0.4782871547875628], [0.0, 0.0, 1.0]], [[1.0755799525343564, 0.0, 0.5312730878744952], [0.0, 1.0813842563213816, 0.49138554444306124], [0.0, 0.0, 1.0]], [[1.0986233565779598, 0.0, 0.5391271834815965], [0.0, 1.108719885666934, 0.4882801280333348], [0.0, 0.0, 1.0]], [[1.0505857699662017, 0.0, 0.50742956290045515], [0.0, 1.0576821247898235, 0.4622735562694957], [0.0, 0.0, 1.0]], [[1.0917212734247041, 0.0, 0.5190519031906807], [0.0, 1.0992158091453805, 0.4866514509020387], [0.0, 0.0, 1.0]], [[1.0690944073686794, 0.0, 0.5518123944877066], [0.0, 1.0696844247548354, 0.47738836153380157], [0.0, 0.0, 1.0]], [[1.0695518031500828, 0.0, 0.5341394277022639], [0.0, 1.076577388170166, 0.4787639569997848], [0.0, 0.0, 1.0]]])

